
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Split-half analysis for selecting the number of components &#8212; TLViz 0.0.9 documentation</title> 
<link rel="stylesheet" href="../_static/tensorly_style.css">
<link rel="apple-touch-icon" sizes="180x180" href="../_static/favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../_static/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../_static/favicon/favicon-16x16.png">
<link rel="manifest" href="../_static/favicon/site.webmanifest">
<link rel="mask-icon" href="../_static/favicon/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="../_static/favicon/favicon.ico">
<meta name="theme-color" content="#ffffff">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tensorly_style.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />

  
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
 <script src="../_static/navbar_burger.js"></script>
 <script defer src="https://use.fontawesome.com/releases/v5.14.0/js/all.js"></script>
 
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Optimisation diagnostics with PARAFAC models" href="plot_optimisation_diagnostic.html" />
    <link rel="prev" title="TLViz + PlotLy for interactive visualisations" href="plot_bike_plotly.html" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

  </head>
<body  class="has-navbar-fixed-top">

  <header>
    <navbar>
      <nav class="navbar top-navbar is-fixed-top has-shadow is-flex-wrap-wrap" role="navigation" aria-label="main top navigation">
        <div class="navbar-brand">
        <!-- Always displayed, last item has to be navbar-burger -->

          <a class="navbar-item" href="../index.html">
            <img src="../_static/tlviz_logo.svg" height="28">
          </a>

          <!-- <a class="navbar-item is-hidden-desktop" href="../index.html">
            <span class="icon"><i class="fa fa-home" aria-hidden="true"></i></span>
          </a> -->
          <a class="navbar-item is-hidden-desktop" href="https://github.com/marieroald/tlviz" target="_blank">
              <span class="icon"><i class="fab fa-github"></i></span>
          </a>

          <a role="button" class="navbar-burger" data-target="top-nav-menu" aria-label="menu" aria-expanded="false">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
          </a>

        </div>
        
        <div class="navbar-menu" id="top-nav-menu">
        <!-- only on larger displays (> 1024px) -->

          <div class="navbar-start">
          <!-- RIGHT -->
            <a class="navbar-item" href="../about_tensors.html">
              Introduction
            </a>
            <a class="navbar-item" href="../installation.html">
              Installation
            </a>
            <a class="navbar-item" href="index.html">
              Examples
            </a>
            <a class="navbar-item" href="../api.html">
              API
            </a>
            <a class="navbar-item" href="https://tensorly.org" target="_blank">
              TensorLy
            </a>

          </div>
        
          <div class="navbar-end">
            <div class="navbar-item">
            <!-- LEFT -->

            <!-- <a class="navbar-item is-hidden-touch" href="../index.html">
              <span class="icon-text">
                <span class="icon">
                  <i class="fa fa-home"></i>
                </span>
                <span>Home</span>
              </span>
              <span class="icon"><i class="fa fa-home" aria-hidden="true"></i></span>
            </a> -->
            <a class="button is-hidden-touch is-dark" href="https://github.com/marieroald/tlviz" target="_blank">
              <span class="icon-text">
                <span class="icon is-large">
                  <i class="fab fa-github"></i>
                </span>
                <span>Github</span>
              </span>
                <!-- <span class="icon"><i class="fab fa-github"></i></span> -->
            </a>

            </div> <!-- navbar item -->
          </div> <!-- navbar end -->
        </div> <!-- only large items -->

      </nav>
      
    </navbar>
  </header>

  <div id="column-container">
  <div class="columns is-mobile is-centered">
	
      <div class="column is-10-mobile is-one-third-tablet is-3-desktop is-hidden-mobile" id="sidebar">
    <!-- Side menu  -->
    <aside class="sticky-nav sidebar-menu">
<div class="sidebar-search">
  <form class="field" id="searchbox" role="search" action="../search.html" method="get">
    <!-- <label class="label" id="searchlabel">Quick search</label> -->
    <div class="field has-addons">
      <div class="control is-expanded">
        <input class="input" type="text" placeholder="Search in TLViz" name="q" aria-labelledby="searchlabel">
      </div>
      <div class="control">
        <input class="button is-info" type="submit" value="Go" />
      </div>
    </div>
  </form>
  <script>$('#searchbox').show(0);</script>
  <script>
  $(document).ready(function() {
    Document.highlightSearchWords = function() {
      var params = $.getQueryParameters();
      var terms = (params.highlight) ? params.highlight[0].split(/\s+/) : [];
      if (terms.length) {
        var body = $('div.body');
        if (!body.length) {
          body = $('body');
        }
        window.setTimeout(function() {
          $.each(terms, function() {
            body.highlightText(this.toLowerCase(), 'highlighted');
          });
        }, 10);
        $('<p class="highlight-link"><a href="javascript:Documentation.' +
          'hideSearchWords()">' + _('Hide All')
          + '<span class="tag is-delete"></span>'
          + '</a></p>')
            .appendTo($('#searchbox'));
      }
    };
  });
  </script>
</div>
      
      <div class="sidebar-menu-toc">
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about_tensors.html">What are tensors and tensor decompositions?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Gallery of examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="plot_labelled_decompositions.html">Labelled decompositions</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_working_with_xarray.html">Working with xarray</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_core_consistency.html">Core consistency</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_bike_plotly.html">TLViz + PlotLy for interactive visualisations</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Split-half analysis for selecting the number of components</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_optimisation_diagnostic.html">Optimisation diagnostics with PARAFAC models</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_selecting_aminoacids_components.html">Selecting the number of components in PARAFAC models</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_outlier_detection.html">Outlier detection with PARAFAC</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tensorly_backends.html">Working with TensorLy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contribution guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>
 
      </div>
    </aside>
  </div>
  

    <div class="column main-column">

      <!-- Main content  -->
      <section class="main-section">

        <!-- Toggle menu button -->
		
        <div class="side-menu-toggle">
          <button class="button" id="toggle-sidebar" onclick="toggle_sidebar()">
            <span class="icon"><i class="fa fa-bars" aria-hidden="true"></i></span>
            <span>menu</span> 
          </button>
        </div>
        

        <div class="content main-content">
          
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-plot-split-half-analysis-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="split-half-analysis-for-selecting-the-number-of-components">
<span id="split-half"></span><span id="sphx-glr-auto-examples-plot-split-half-analysis-py"></span><h1>Split-half analysis for selecting the number of components<a class="headerlink" href="#split-half-analysis-for-selecting-the-number-of-components" title="Permalink to this headline">¶</a></h1>
<p>In this example, we will look at how we can use split-half analysis to select the number of PARAFAC components.</p>
<p>The idea of split-half analysis is that we want to find the same underlying patterns if we look at different representative subsets of the same data.
To accomplish this, we split the dataset in two equally sized non-overlapping pieces along one mode and fit a PARAFAC model to both pieces.
Then, we compare the similarity of the factors in the other, non-split modes.</p>
<p>Generally, we would split the sample mode, but sometimes, it may also make sense to split other modes. For example,
if we have a time series and expect the same patterns to be present in two subsequent periods, then we may split
the data along the temporal mode instead.</p>
<section id="imports-and-utilities">
<h2>Imports and utilities<a class="headerlink" href="#imports-and-utilities" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">tensorly.decomposition</span> <span class="kn">import</span> <span class="n">parafac</span>

<span class="kn">import</span> <span class="nn">tlviz</span>

<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>To fit PARAFAC models, we need to solve a non-convex optimization problem, possibly with local minima. It is
therefore useful to fit several models with the same number of components using many different random
initialisations.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fit_many_parafac</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">num_components</span><span class="p">,</span> <span class="n">num_inits</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">parafac</span><span class="p">(</span>
            <span class="n">X</span><span class="p">,</span>
            <span class="n">num_components</span><span class="p">,</span>
            <span class="n">n_iter_max</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
            <span class="n">tol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">,</span>
            <span class="n">init</span><span class="o">=</span><span class="s2">&quot;random&quot;</span><span class="p">,</span>
            <span class="n">orthogonalise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">linesearch</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">random_state</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_inits</span><span class="p">)</span>
    <span class="p">]</span>
</pre></div>
</div>
</section>
<section id="creating-simulated-data">
<h2>Creating simulated data<a class="headerlink" href="#creating-simulated-data" title="Permalink to this headline">¶</a></h2>
<p>We start with some simulated data, since then, we know exactly how many components there are in the data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cp_tensor</span><span class="p">,</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">tlviz</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">simulated_random_cp_tensor</span><span class="p">((</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="n">noise_level</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">labelled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="splitting-the-data">
<h2>Splitting the data<a class="headerlink" href="#splitting-the-data" title="Permalink to this headline">¶</a></h2>
<p>We split the data randomly along the second mode</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">I</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">K</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">shape</span>

<span class="n">permutation</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<span class="n">splits</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">dataset</span><span class="o">.</span><span class="n">loc</span><span class="p">[{</span><span class="s2">&quot;Mode 1&quot;</span><span class="p">:</span> <span class="n">permutation</span><span class="p">[:</span> <span class="n">J</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]}],</span>
    <span class="n">dataset</span><span class="o">.</span><span class="n">loc</span><span class="p">[{</span><span class="s2">&quot;Mode 1&quot;</span><span class="p">:</span> <span class="n">permutation</span><span class="p">[</span><span class="n">J</span> <span class="o">//</span> <span class="mi">2</span> <span class="p">:]}],</span>
<span class="p">]</span>
</pre></div>
</div>
</section>
<section id="fitting-models-to-the-split-data">
<h2>Fitting models to the split data<a class="headerlink" href="#fitting-models-to-the-split-data" title="Permalink to this headline">¶</a></h2>
<p>We split the data randomly along the second mode</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">rank</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">rank</span><span class="si">}</span><span class="s2"> components&quot;</span><span class="p">)</span>
    <span class="n">models</span><span class="p">[</span><span class="n">rank</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">split</span> <span class="ow">in</span> <span class="n">splits</span><span class="p">:</span>
        <span class="n">current_models</span> <span class="o">=</span> <span class="n">fit_many_parafac</span><span class="p">(</span><span class="n">split</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">rank</span><span class="p">)</span>
        <span class="n">current_model</span> <span class="o">=</span> <span class="n">tlviz</span><span class="o">.</span><span class="n">multimodel_evaluation</span><span class="o">.</span><span class="n">get_model_with_lowest_error</span><span class="p">(</span><span class="n">current_models</span><span class="p">,</span> <span class="n">split</span><span class="p">)</span>
        <span class="n">models</span><span class="p">[</span><span class="n">rank</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_model</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>1 components
2 components
3 components
4 components
5 components
</pre></div>
</div>
</section>
<section id="computing-factor-similarity">
<h2>Computing factor similarity<a class="headerlink" href="#computing-factor-similarity" title="Permalink to this headline">¶</a></h2>
<p>Now, we compute the similarity between the two splits for the different numbers of components.
However, we cannot compare the second mode (<code class="docutils literal notranslate"><span class="pre">mode=1</span></code>), since that was the mode we sampled randomly
in. Also, we cannot consider the weights in the factor match score since the weight will also be
affected by the sampling.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">split_half_stability</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">rank</span><span class="p">,</span> <span class="p">(</span><span class="n">cp_1</span><span class="p">,</span> <span class="n">cp_2</span><span class="p">)</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">fms</span> <span class="o">=</span> <span class="n">tlviz</span><span class="o">.</span><span class="n">factor_tools</span><span class="o">.</span><span class="n">factor_match_score</span><span class="p">(</span><span class="n">cp_1</span><span class="p">,</span> <span class="n">cp_2</span><span class="p">,</span> <span class="n">consider_weights</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">skip_mode</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">split_half_stability</span><span class="p">[</span><span class="n">rank</span><span class="p">]</span> <span class="o">=</span> <span class="n">fms</span>
</pre></div>
</div>
</section>
<section id="plotting-the-factor-similarity">
<h2>Plotting the  factor similarity<a class="headerlink" href="#plotting-the-factor-similarity" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">split_half_stability</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">split_half_stability</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="s2">&quot;-o&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_split_half_analysis_001.png" srcset="../_images/sphx_glr_plot_split_half_analysis_001.png" alt="plot split half analysis" class = "sphx-glr-single-img"/><p>As we can see, there is a sharp drop in stability when increasing from four to five components.
This drop indicates that the patterns we find with a five-component model are not robust to small changes in the data.
In this case, this result is expected because we simulated the data and know that it contains only four components.
So to fit a five-component model to this four-component data, the model might split the information in one of the
“true” components into two or more model components and possibly mix some of the components.
Since this splitting and mixing can be done in many ways, we no longer have a stable decomposition, causing the
sharp drop we see in the plot.</p>
<p>So we see that visualising the split-half stability can be a helpful way to evaluate how many components you should
use to model your data.</p>
</section>
<section id="split-half-analysis-for-the-bike-sharing-data">
<h2>Split-half analysis for the bike sharing data<a class="headerlink" href="#split-half-analysis-for-the-bike-sharing-data" title="Permalink to this headline">¶</a></h2>
<p>Here, we try split-half analysis on bike sharing data from Oslo. This dataset has five modes:</p>
<blockquote>
<div><ul class="simple">
<li><p>End station</p></li>
<li><p>Year</p></li>
<li><p>Month</p></li>
<li><p>Day of week</p></li>
<li><p>Hour of day</p></li>
</ul>
</div></blockquote>
<p>The dataset covers all bike trips during 2020 and 2021, and we would expect to find appoximately
the same patterns for the two years. We can therefore form two new tensors, one for 2020 and one
for 2021, fit PARAFAC models for these two datasets and compare the similarity of the components.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bike_data</span> <span class="o">=</span> <span class="n">tlviz</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">load_oslo_city_bike</span><span class="p">()</span>

<span class="n">splits</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">bike_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[{</span><span class="s2">&quot;Year&quot;</span><span class="p">:</span> <span class="mi">2020</span><span class="p">}],</span>
    <span class="n">bike_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[{</span><span class="s2">&quot;Year&quot;</span><span class="p">:</span> <span class="mi">2021</span><span class="p">}],</span>
<span class="p">]</span>

<span class="n">bike_models</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">rank</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">rank</span><span class="si">}</span><span class="s2"> components&quot;</span><span class="p">)</span>
    <span class="n">bike_models</span><span class="p">[</span><span class="n">rank</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">split</span> <span class="ow">in</span> <span class="n">splits</span><span class="p">:</span>
        <span class="n">current_models</span> <span class="o">=</span> <span class="n">fit_many_parafac</span><span class="p">(</span><span class="n">split</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">rank</span><span class="p">)</span>
        <span class="n">current_model</span> <span class="o">=</span> <span class="n">tlviz</span><span class="o">.</span><span class="n">multimodel_evaluation</span><span class="o">.</span><span class="n">get_model_with_lowest_error</span><span class="p">(</span><span class="n">current_models</span><span class="p">,</span> <span class="n">split</span><span class="p">)</span>
        <span class="n">bike_models</span><span class="p">[</span><span class="n">rank</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_model</span><span class="p">)</span>

<span class="n">bike_stability</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">rank</span><span class="p">,</span> <span class="p">(</span><span class="n">cp_1</span><span class="p">,</span> <span class="n">cp_2</span><span class="p">)</span> <span class="ow">in</span> <span class="n">bike_models</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">fms</span> <span class="o">=</span> <span class="n">tlviz</span><span class="o">.</span><span class="n">factor_tools</span><span class="o">.</span><span class="n">factor_match_score</span><span class="p">(</span><span class="n">cp_1</span><span class="p">,</span> <span class="n">cp_2</span><span class="p">,</span> <span class="n">consider_weights</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">skip_mode</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">bike_stability</span><span class="p">[</span><span class="n">rank</span><span class="p">]</span> <span class="o">=</span> <span class="n">fms</span>


<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bike_stability</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">bike_stability</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="s2">&quot;-o&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_split_half_analysis_002.png" srcset="../_images/sphx_glr_plot_split_half_analysis_002.png" alt="plot split half analysis" class = "sphx-glr-single-img"/><p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>1 components
2 components
3 components
4 components
5 components
</pre></div>
</div>
<p>Based on this split-half analysis, we see that we find three components that are present in both
years. The moment we go up to four components, the stability drastically falls, and it falls even
further with five components. This indicates that three components is a good choice for the model.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 1 minutes  33.145 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-plot-split-half-analysis-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/0e39f97161617046c828b84f5b1099ea/plot_split_half_analysis.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_split_half_analysis.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/ed2e2154d63539833c79706353204ea5/plot_split_half_analysis.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_split_half_analysis.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


        </div>

		
        <nav class="pagination" role="navigation" aria-label="pagination">
    
    <a class="button is-medium pagination-previous" href="plot_bike_plotly.html" title="previous page" accesskey="p">
        <span class="icon">
            <i class="fa fa-arrow-circle-left"></i>
        </span>
        <span>TLViz + PlotLy for interactive visualisations</span>
    </a>
    
    
    <a class="button is-medium pagination-next" href="plot_optimisation_diagnostic.html" title="next page" accesskey="n">
        <span>Optimisation diagnostics with PARAFAC models </span>
        <span class="icon">
            <i class="fa fa-arrow-circle-right"></i>
        </span>
    </a>
    
</nav>

        

      </section>

        <footer class="footer">
    <div class="content has-text-centered">
        <div class="block">
          &copy; Copyright 2021, Marie Roald &amp; Yngve Mardal Moe.<br/>
        </div>
      <div class="block">
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> and the <a href="tensorly.org"><strong>TensorLy</strong></a> theme by <a href="jeankossaifi.com">Jean Kossaifi</a>.
      </div>
    </div>
  </footer>

    </div>

	
    
    <div class="column is-hidden-touch is-2-desktop is-one-fifth-widescreen" id="localtoc-column">

    <aside class="sticky-nav localtoc">  
        <div class="menu menu-list">
        <p class="menu-label">On this page</p>
        <ul>
<li><a class="reference internal" href="#">Split-half analysis for selecting the number of components</a><ul>
<li><a class="reference internal" href="#imports-and-utilities">Imports and utilities</a></li>
<li><a class="reference internal" href="#creating-simulated-data">Creating simulated data</a></li>
<li><a class="reference internal" href="#splitting-the-data">Splitting the data</a></li>
<li><a class="reference internal" href="#fitting-models-to-the-split-data">Fitting models to the split data</a></li>
<li><a class="reference internal" href="#computing-factor-similarity">Computing factor similarity</a></li>
<li><a class="reference internal" href="#plotting-the-factor-similarity">Plotting the  factor similarity</a></li>
<li><a class="reference internal" href="#split-half-analysis-for-the-bike-sharing-data">Split-half analysis for the bike sharing data</a></li>
</ul>
</li>
</ul>

        </div>
    </aside>
    </div>

    

  </div>
  </div>

  <!-- Include here scripts that need to be added after the page is loaded -->
  <script>
    function toggle_sidebar() {
        var element = document.getElementById("sidebar");
        var container = document.getElementById("column-container");
        var localtoccolumn = document.getElementById("localtoc-column");
        element.classList.toggle("hide-tablet");
        element.classList.toggle("is-hidden-mobile");
        container.classList.toggle("sidemenu-hidden");
        localtoccolumn.classList.toggle("is-one-fifth-widescreen");
        localtoccolumn.classList.toggle("is-2-desktop");
        localtoccolumn.classList.toggle("is-3-desktop");
    }
  </script> 



  </body>
</html>