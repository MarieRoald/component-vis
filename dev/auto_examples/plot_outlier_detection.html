
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Outlier detection with PARAFAC &#8212; TLViz 0.0.7 documentation</title> 
<link rel="stylesheet" href="../_static/tensorly_style.css">
<link rel="apple-touch-icon" sizes="180x180" href="../_static/favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../_static/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../_static/favicon/favicon-16x16.png">
<link rel="manifest" href="../_static/favicon/site.webmanifest">
<link rel="mask-icon" href="../_static/favicon/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="../_static/favicon/favicon.ico">
<meta name="theme-color" content="#ffffff">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tensorly_style.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />

  
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
 <script src="../_static/navbar_burger.js"></script>
 <script defer src="https://use.fontawesome.com/releases/v5.14.0/js/all.js"></script>
 
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="API Reference" href="../api.html" />
    <link rel="prev" title="Selecting the number of components in PARAFAC models" href="plot_selecting_aminoacids_components.html" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

  </head>
<body  class="has-navbar-fixed-top">

  <header>
    <navbar>
      <nav class="navbar top-navbar is-fixed-top has-shadow is-flex-wrap-wrap" role="navigation" aria-label="main top navigation">
        <div class="navbar-brand">
        <!-- Always displayed, last item has to be navbar-burger -->

          <a class="navbar-item" href="../index.html">
            <img src="../_static/tlviz_logo.svg" height="28">
          </a>

          <!-- <a class="navbar-item is-hidden-desktop" href="../index.html">
            <span class="icon"><i class="fa fa-home" aria-hidden="true"></i></span>
          </a> -->
          <a class="navbar-item is-hidden-desktop" href="https://github.com/marieroald/tlviz" target="_blank">
              <span class="icon"><i class="fab fa-github"></i></span>
          </a>

          <a role="button" class="navbar-burger" data-target="top-nav-menu" aria-label="menu" aria-expanded="false">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
          </a>

        </div>
        
        <div class="navbar-menu" id="top-nav-menu">
        <!-- only on larger displays (> 1024px) -->

          <div class="navbar-start">
          <!-- RIGHT -->
            <a class="navbar-item" href="../about_tensors.html">
              Introduction
            </a>
            <a class="navbar-item" href="../installation.html">
              Installation
            </a>
            <a class="navbar-item" href="index.html">
              Examples
            </a>
            <a class="navbar-item" href="../api.html">
              API
            </a>
            <a class="navbar-item" href="https://tensorly.org" target="_blank">
              TensorLy
            </a>

          </div>
        
          <div class="navbar-end">
            <div class="navbar-item">
            <!-- LEFT -->

            <!-- <a class="navbar-item is-hidden-touch" href="../index.html">
              <span class="icon-text">
                <span class="icon">
                  <i class="fa fa-home"></i>
                </span>
                <span>Home</span>
              </span>
              <span class="icon"><i class="fa fa-home" aria-hidden="true"></i></span>
            </a> -->
            <a class="button is-hidden-touch is-dark" href="https://github.com/marieroald/tlviz" target="_blank">
              <span class="icon-text">
                <span class="icon is-large">
                  <i class="fab fa-github"></i>
                </span>
                <span>Github</span>
              </span>
                <!-- <span class="icon"><i class="fab fa-github"></i></span> -->
            </a>

            </div> <!-- navbar item -->
          </div> <!-- navbar end -->
        </div> <!-- only large items -->

      </nav>
      
    </navbar>
  </header>

  <div id="column-container">
  <div class="columns is-mobile is-centered">
	
      <div class="column is-10-mobile is-one-third-tablet is-3-desktop is-hidden-mobile" id="sidebar">
    <!-- Side menu  -->
    <aside class="sticky-nav sidebar-menu">
<div class="sidebar-search">
  <form class="field" id="searchbox" role="search" action="../search.html" method="get">
    <!-- <label class="label" id="searchlabel">Quick search</label> -->
    <div class="field has-addons">
      <div class="control is-expanded">
        <input class="input" type="text" placeholder="Search in TLViz" name="q" aria-labelledby="searchlabel">
      </div>
      <div class="control">
        <input class="button is-info" type="submit" value="Go" />
      </div>
    </div>
  </form>
  <script>$('#searchbox').show(0);</script>
  <script>
  $(document).ready(function() {
    Document.highlightSearchWords = function() {
      var params = $.getQueryParameters();
      var terms = (params.highlight) ? params.highlight[0].split(/\s+/) : [];
      if (terms.length) {
        var body = $('div.body');
        if (!body.length) {
          body = $('body');
        }
        window.setTimeout(function() {
          $.each(terms, function() {
            body.highlightText(this.toLowerCase(), 'highlighted');
          });
        }, 10);
        $('<p class="highlight-link"><a href="javascript:Documentation.' +
          'hideSearchWords()">' + _('Hide All')
          + '<span class="tag is-delete"></span>'
          + '</a></p>')
            .appendTo($('#searchbox'));
      }
    };
  });
  </script>
</div>
      
      <div class="sidebar-menu-toc">
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about_tensors.html">What are tensors and tensor decompositions?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Gallery of examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="plot_labelled_decompositions.html">Labelled decompositions</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_working_with_xarray.html">Working with xarray</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_core_consistency.html">Core consistency</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_bike_plotly.html">TLViz + PlotLy for interactive visualisations</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_split_half_analysis.html">Split-half analysis for selecting the number of components</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_optimisation_diagnostic.html">Optimisation diagnostics with PARAFAC models</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_selecting_aminoacids_components.html">Selecting the number of components in PARAFAC models</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Outlier detection with PARAFAC</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tensorly_backends.html">Working with TensorLy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contribution guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>
 
      </div>
    </aside>
  </div>
  

    <div class="column main-column">

      <!-- Main content  -->
      <section class="main-section">

        <!-- Toggle menu button -->
		
        <div class="side-menu-toggle">
          <button class="button" id="toggle-sidebar" onclick="toggle_sidebar()">
            <span class="icon"><i class="fa fa-bars" aria-hidden="true"></i></span>
            <span>menu</span> 
          </button>
        </div>
        

        <div class="content main-content">
          
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-plot-outlier-detection-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="outlier-detection-with-parafac">
<span id="outlier-detection"></span><span id="sphx-glr-auto-examples-plot-outlier-detection-py"></span><h1>Outlier detection with PARAFAC<a class="headerlink" href="#outlier-detection-with-parafac" title="Permalink to this headline">¶</a></h1>
<p>There are two metrics that are commonly used for detecting outliers in PARAFAC models: <em>leverage</em> and <em>residuals</em>.</p>
<section id="residuals">
<h2>Residuals<a class="headerlink" href="#residuals" title="Permalink to this headline">¶</a></h2>
<p>The residuals measure how well the PARAFAC model represents the data. For detecting outliers, it is common
to compute the sum of squared error for each sample. Since each sample corresponds to a slab in the data tensor,
we use the name <em>slabwise SSE</em> in TLViz. For a third-order tensor, <span class="math notranslate nohighlight">\(\mathcal{X}\)</span>, and its PARAFAC
estimate, <span class="math notranslate nohighlight">\(\hat{\mathcal{X}}\)</span>, we compute the <span class="math notranslate nohighlight">\(i\)</span>-th residual in the first mode as</p>
<div class="math notranslate nohighlight">
\[r_i = \sum_{jk} \left(x_{ijk} - \hat{x}_{ijk}\right)^2.\]</div>
<p>These residuals measure how well our decomposition fits the different samples. If a sample, <span class="math notranslate nohighlight">\(i\)</span>, has a high
residual, then that indicates that our PARAFAC model cannot describe its behaviour.</p>
</section>
<section id="leverage">
<h2>Leverage<a class="headerlink" href="#leverage" title="Permalink to this headline">¶</a></h2>
<p>The leverage score measures how “influential” the different samples are for the PARAFAC model. There
are several interpretations of the leverage score <span id="id1">[<a class="reference internal" href="../references.html#id21" title="Paul F Velleman and Roy E Welsch. Efficient computing of regression diagnostics. The American Statistician, 35(4):234–242, 1981.">VW81</a>]</span>, one of them is the
number of components we devote to a given data point. To compute the leverage score for the different samples,
we only need the factor matrix for the sample mode. If the sample mode is represented by <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>,
then the leverage score is defined as</p>
<div class="math notranslate nohighlight">
\[h_i = \left[\mathbf{A} \left(\mathbf{A}^T \mathbf{A}\right)^{-1} \mathbf{A}^T\right]_{ii},\]</div>
<p>that is, the <span class="math notranslate nohighlight">\(i\)</span>-th diagonal entry of the matrix
<span class="math notranslate nohighlight">\(\mathbf{A} \left(\mathbf{A}^T \mathbf{A}\right)^{-1} \mathbf{A}^T\)</span>.</p>
</section>
<section id="examples-with-code">
<h2>Examples with code<a class="headerlink" href="#examples-with-code" title="Permalink to this headline">¶</a></h2>
<p>Below, we show some examples with simulated data to illustrate how we can use the leverage and residuals to
find and remove the outliers in a dataset.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">tensorly.decomposition</span> <span class="kn">import</span> <span class="n">parafac</span>

<span class="kn">import</span> <span class="nn">tlviz</span>
</pre></div>
</div>
<section id="utility-for-fitting-parafac-models-and-sampling-cp-tensors">
<h3>Utility for fitting PARAFAC models and sampling CP tensors<a class="headerlink" href="#utility-for-fitting-parafac-models-and-sampling-cp-tensors" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fit_parafac</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">num_components</span><span class="p">,</span> <span class="n">num_inits</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">model_candidates</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">parafac</span><span class="p">(</span>
            <span class="n">X</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
            <span class="n">num_components</span><span class="p">,</span>
            <span class="n">n_iter_max</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
            <span class="n">tol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">,</span>
            <span class="n">init</span><span class="o">=</span><span class="s2">&quot;random&quot;</span><span class="p">,</span>
            <span class="n">orthogonalise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">linesearch</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">random_state</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_inits</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">tlviz</span><span class="o">.</span><span class="n">multimodel_evaluation</span><span class="o">.</span><span class="n">get_model_with_lowest_error</span><span class="p">(</span><span class="n">model_candidates</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tlviz</span><span class="o">.</span><span class="n">postprocessing</span><span class="o">.</span><span class="n">postprocess</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">index_cp_tensor</span><span class="p">(</span><span class="n">cp_tensor</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">mode</span><span class="p">):</span>
    <span class="n">weights</span><span class="p">,</span> <span class="n">factors</span> <span class="o">=</span> <span class="n">cp_tensor</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
    <span class="n">new_factors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fm</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">factors</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">mode</span><span class="p">:</span>
            <span class="n">new_factors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fm</span><span class="p">[</span><span class="n">fm</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">indices</span><span class="p">)])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_factors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fm</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">weights</span><span class="p">,</span> <span class="n">new_factors</span>
</pre></div>
</div>
</section>
<section id="generate-simulated-dataset">
<h3>Generate simulated dataset<a class="headerlink" href="#generate-simulated-dataset" title="Permalink to this headline">¶</a></h3>
<p>We start by generating a random CP Tensor where the first mode represents the sample mode,
and the other two modes represent some signal we have measured.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">I</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">K</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span>
<span class="n">rank</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">offset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">rank</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>

<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">((</span><span class="n">I</span><span class="p">,</span> <span class="n">rank</span><span class="p">)))</span>
<span class="n">A</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Mode 0&quot;</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">offset</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">J</span><span class="p">)[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">/</span> <span class="n">rank</span> <span class="o">+</span> <span class="n">offset</span><span class="p">))</span>
<span class="n">B</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Mode 1&quot;</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">offset</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">K</span><span class="p">)[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">/</span> <span class="n">rank</span> <span class="o">+</span> <span class="n">offset</span><span class="p">))</span>
<span class="n">C</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Mode 2&quot;</span>


<span class="n">true_model</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="plotting-the-components">
<h3>Plotting the components<a class="headerlink" href="#plotting-the-components" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tlviz</span><span class="o">.</span><span class="n">visualisation</span><span class="o">.</span><span class="n">components_plot</span><span class="p">(</span><span class="n">true_model</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_outlier_detection_001.png" srcset="../_images/sphx_glr_plot_outlier_detection_001.png" alt="plot outlier detection" class = "sphx-glr-single-img"/></section>
<section id="adding-artificial-noise">
<h3>Adding artificial noise<a class="headerlink" href="#adding-artificial-noise" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">tlviz</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">cp_to_tensor</span><span class="p">(</span><span class="n">true_model</span><span class="p">)</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">noise</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">noise</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="adding-artificial-outliers">
<h3>Adding artificial outliers<a class="headerlink" href="#adding-artificial-outliers" title="Permalink to this headline">¶</a></h3>
<p>We need three outliers to find; let’s make three of the first four samples into outliers.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">10</span>
<span class="n">X</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">5</span>
</pre></div>
</div>
</section>
<section id="fitting-a-parafac-model-to-this-data-and-plotting-the-components">
<h3>Fitting a PARAFAC model to this data and plotting the components<a class="headerlink" href="#fitting-a-parafac-model-to-this-data-and-plotting-the-components" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">first_attempt</span> <span class="o">=</span> <span class="n">fit_parafac</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">rank</span><span class="p">,</span> <span class="n">num_inits</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">tlviz</span><span class="o">.</span><span class="n">visualisation</span><span class="o">.</span><span class="n">component_comparison_plot</span><span class="p">({</span><span class="s2">&quot;True&quot;</span><span class="p">:</span> <span class="n">true_model</span><span class="p">,</span> <span class="s2">&quot;First attempt&quot;</span><span class="p">:</span> <span class="n">first_attempt</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_outlier_detection_002.png" srcset="../_images/sphx_glr_plot_outlier_detection_002.png" alt="plot outlier detection" class = "sphx-glr-single-img"/><p>We see that some of the components are wrong, and to quantify this, we can look at the factor match score:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fms</span> <span class="o">=</span> <span class="n">tlviz</span><span class="o">.</span><span class="n">factor_tools</span><span class="o">.</span><span class="n">factor_match_score</span><span class="p">(</span><span class="n">true_model</span><span class="p">,</span> <span class="n">first_attempt</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The FMS is </span><span class="si">{</span><span class="n">fms</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>The FMS is 0.39
</pre></div>
</div>
<p>Next, we can create a scatter plot where we plot the leverage and residuals for each sample.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tlviz</span><span class="o">.</span><span class="n">visualisation</span><span class="o">.</span><span class="n">outlier_plot</span><span class="p">(</span><span class="n">first_attempt</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_outlier_detection_003.png" srcset="../_images/sphx_glr_plot_outlier_detection_003.png" alt="Outlier plot for Mode 0" class = "sphx-glr-single-img"/><p>From this plot, we see that there are three potential outliers.
First, sample 2 has a high leverage and a high residual.
The leverage is close to one, so we almost devote a whole component to modelling it.
And still, it is poorly described by the model.
We also see that sample 3 has a high leverage and low error,
and sample 0 has a low leverage and a high error.
Let’s start by removing the most problematic sample: Sample 2.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">samples_to_remove</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span><span class="p">}</span>
<span class="n">selected_samples</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">samples_to_remove</span><span class="p">]</span>
<span class="n">sampled_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">loc</span><span class="p">[{</span><span class="s2">&quot;Mode 0&quot;</span><span class="p">:</span> <span class="n">selected_samples</span><span class="p">}]</span>
<span class="n">second_attempt</span> <span class="o">=</span> <span class="n">fit_parafac</span><span class="p">(</span><span class="n">sampled_X</span><span class="p">,</span> <span class="n">rank</span><span class="p">,</span> <span class="n">num_inits</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>Next, we want to compare the true and estimated components.
However, since we have removed a slab from the dataset,
we also need to remove the corresponding row from <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>
before we can compare the components.
Otherwise, we could not align the components.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sampled_true_cp</span> <span class="o">=</span> <span class="n">index_cp_tensor</span><span class="p">(</span><span class="n">true_model</span><span class="p">,</span> <span class="n">selected_samples</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">tlviz</span><span class="o">.</span><span class="n">visualisation</span><span class="o">.</span><span class="n">component_comparison_plot</span><span class="p">({</span><span class="s2">&quot;True&quot;</span><span class="p">:</span> <span class="n">sampled_true_cp</span><span class="p">,</span> <span class="s2">&quot;Second attempt&quot;</span><span class="p">:</span> <span class="n">second_attempt</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_outlier_detection_004.png" srcset="../_images/sphx_glr_plot_outlier_detection_004.png" alt="plot outlier detection" class = "sphx-glr-single-img"/><p>Still, we have not successfully recovered the correct components,
which is apparent from the factor match score.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fms</span> <span class="o">=</span> <span class="n">tlviz</span><span class="o">.</span><span class="n">factor_tools</span><span class="o">.</span><span class="n">factor_match_score</span><span class="p">(</span><span class="n">sampled_true_cp</span><span class="p">,</span> <span class="n">second_attempt</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The FMS is </span><span class="si">{</span><span class="n">fms</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>The FMS is 0.66
</pre></div>
</div>
<p>We can also create the outlier plot again to see which samples are suspicious.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tlviz</span><span class="o">.</span><span class="n">visualisation</span><span class="o">.</span><span class="n">outlier_plot</span><span class="p">(</span><span class="n">second_attempt</span><span class="p">,</span> <span class="n">sampled_X</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_outlier_detection_005.png" srcset="../_images/sphx_glr_plot_outlier_detection_005.png" alt="Outlier plot for Mode 0" class = "sphx-glr-single-img"/><p>We see that sample 0 and 3 still show the same behaviour as before. Sample 0 has a high error, but does not affect
the model much, while sample 3 has a low error, but does affect the model. Let us therefore remove sample 3 now.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">samples_to_remove</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">}</span>
<span class="n">selected_samples</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">samples_to_remove</span><span class="p">]</span>
<span class="n">sampled_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">loc</span><span class="p">[{</span><span class="s2">&quot;Mode 0&quot;</span><span class="p">:</span> <span class="n">selected_samples</span><span class="p">}]</span>
<span class="n">third_attempt</span> <span class="o">=</span> <span class="n">fit_parafac</span><span class="p">(</span><span class="n">sampled_X</span><span class="p">,</span> <span class="n">rank</span><span class="p">,</span> <span class="n">num_inits</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">sampled_true_cp</span> <span class="o">=</span> <span class="n">index_cp_tensor</span><span class="p">(</span><span class="n">true_model</span><span class="p">,</span> <span class="n">selected_samples</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">tlviz</span><span class="o">.</span><span class="n">visualisation</span><span class="o">.</span><span class="n">component_comparison_plot</span><span class="p">({</span><span class="s2">&quot;True&quot;</span><span class="p">:</span> <span class="n">sampled_true_cp</span><span class="p">,</span> <span class="s2">&quot;Third attempt&quot;</span><span class="p">:</span> <span class="n">third_attempt</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_outlier_detection_006.png" srcset="../_images/sphx_glr_plot_outlier_detection_006.png" alt="plot outlier detection" class = "sphx-glr-single-img"/><p>Here, we see that we finally uncovered the true components. This is also apparent from the FMS</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fms</span> <span class="o">=</span> <span class="n">tlviz</span><span class="o">.</span><span class="n">factor_tools</span><span class="o">.</span><span class="n">factor_match_score</span><span class="p">(</span><span class="n">sampled_true_cp</span><span class="p">,</span> <span class="n">third_attempt</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The FMS is </span><span class="si">{</span><span class="n">fms</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>The FMS is 0.97
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Here, we remove the outlier with a very high leverage.
However, sometimes, it is better to include the samples with a high leverage
and low residual and increase the number of components.
Then the additional components can model the samples with the high leverage scores.
In this example, we could have increased the number of components by one
and recovered the correct components without removing this sample.</p>
</div>
<p>We can also create the outlier plot again to see if there still are any suspicious samples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tlviz</span><span class="o">.</span><span class="n">visualisation</span><span class="o">.</span><span class="n">outlier_plot</span><span class="p">(</span><span class="n">third_attempt</span><span class="p">,</span> <span class="n">sampled_X</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_outlier_detection_007.png" srcset="../_images/sphx_glr_plot_outlier_detection_007.png" alt="Outlier plot for Mode 0" class = "sphx-glr-single-img"/><p>Let’s see what happens when we also remove the final suspicious sample</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">samples_to_remove</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">}</span>
<span class="n">selected_samples</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">samples_to_remove</span><span class="p">]</span>
<span class="n">sampled_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">loc</span><span class="p">[{</span><span class="s2">&quot;Mode 0&quot;</span><span class="p">:</span> <span class="n">selected_samples</span><span class="p">}]</span>
<span class="n">fourth_attempt</span> <span class="o">=</span> <span class="n">fit_parafac</span><span class="p">(</span><span class="n">sampled_X</span><span class="p">,</span> <span class="n">rank</span><span class="p">,</span> <span class="n">num_inits</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">sampled_true_cp</span> <span class="o">=</span> <span class="n">index_cp_tensor</span><span class="p">(</span><span class="n">true_model</span><span class="p">,</span> <span class="n">selected_samples</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">tlviz</span><span class="o">.</span><span class="n">visualisation</span><span class="o">.</span><span class="n">component_comparison_plot</span><span class="p">({</span><span class="s2">&quot;True&quot;</span><span class="p">:</span> <span class="n">sampled_true_cp</span><span class="p">,</span> <span class="s2">&quot;Fourth attempt&quot;</span><span class="p">:</span> <span class="n">fourth_attempt</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_outlier_detection_008.png" srcset="../_images/sphx_glr_plot_outlier_detection_008.png" alt="plot outlier detection" class = "sphx-glr-single-img"/><p>The components didn’t change much.</p>
<p>We didn’t need to remove the final suspicious outlier in this case,
and after removing it, the components didn’t change much.
This behaviour makes sense because the sample had a very low leverage,
so it didn’t affect the model very much.
So, in cases where a data point has high residual but not high leverage,
it might be sensible not to remove it.</p>
</section>
<section id="rules-of-thumb-for-selecting-the-samples-that-may-be-outliers">
<h3>Rules-of-thumb for selecting the samples that may be outliers<a class="headerlink" href="#rules-of-thumb-for-selecting-the-samples-that-may-be-outliers" title="Permalink to this headline">¶</a></h3>
<p>Unfortunately, there are no hard rules for selecting which samples to remove as outliers.
Instead, we generally have to consider each suspected outlier individually.
However, there are some useful rules-of-thumb discussed in the literature.
These methods are detailed in <a class="reference internal" href="../api/outliers.html#tlviz.outliers.get_slabwise_sse_outlier_threshold" title="tlviz.outliers.get_slabwise_sse_outlier_threshold"><code class="xref py py-meth docutils literal notranslate"><span class="pre">tlviz.outliers.get_slabwise_sse_outlier_threshold()</span></code></a>
and <a class="reference internal" href="../api/outliers.html#tlviz.outliers.get_slabwise_sse_outlier_threshold" title="tlviz.outliers.get_slabwise_sse_outlier_threshold"><code class="xref py py-meth docutils literal notranslate"><span class="pre">tlviz.outliers.get_slabwise_sse_outlier_threshold()</span></code></a>.
There are two ways to select outliers based on the leverage score.
If we interpret the leverage score as the number of components devoted to each sample,
which Huber does in <span id="id2">[<a class="reference internal" href="../references.html#id6" title="P.J. Huber and E.M. Ronchetti. Robust Statistics. Wiley Series in Probability and Statistics. Wiley, 2009. ISBN 9780470129906.">HR09</a>]</span>,
then it makes sense to use a constant cut-off equal to 0.5
(we devote more than half a component to model a single sample) or 0.2
(we devote 20% of a component for a single sample).
Alternatively, we can assume that the components are normally distributed
and use probability theory to estimate the cut-off values.
This approach is what Hoaglin and Welch use in <span id="id3">[<a class="reference internal" href="../references.html#id7" title="D.A. Belsley, E. Kuh, and R.E. Welsch. Regression Diagnostics: Identifying Influential Data and Sources of Collinearity. Wiley Series in Probability and Statistics - Applied Probability and Statistics Section Series. Wiley, 1980. ISBN 9780471058564.">BKW80</a>]</span>
to obtain their easy-to-compute thresholds.
Finally, we can compute the thresholds using p-values by assuming that the data
either comes from a normal distribution <span id="id4">[<a class="reference internal" href="../references.html#id7" title="D.A. Belsley, E. Kuh, and R.E. Welsch. Regression Diagnostics: Identifying Influential Data and Sources of Collinearity. Wiley Series in Probability and Statistics - Applied Probability and Statistics Section Series. Wiley, 1980. ISBN 9780471058564.">BKW80</a>]</span>,
or from a zero-mean normal distribution  <span id="id5">[<a class="reference internal" href="../references.html#id16" title="Paul Nomikos and John F MacGregor. Multivariate SPC charts for monitoring batch processes. Technometrics, 37(1):41–59, 1995.">NM95</a>]</span>
(Hotelling T2 p-values).
For selecting the outliers based on the residuals,
we can either assume that the noise is normally distributed
and compute the cut-off values with p-values via a chi-squared distribution
<span id="id6">[<a class="reference internal" href="../references.html#id16" title="Paul Nomikos and John F MacGregor. Multivariate SPC charts for monitoring batch processes. Technometrics, 37(1):41–59, 1995.">NM95</a>]</span>,
or we can set the cut-off equal to twice the standard deviation of the SSE <span id="id7">[<a class="reference internal" href="../references.html#id8" title="Tormod Næs, Tomas Isaksson, Tom Fearn, and Tony Davies. A user-friendly guide to multivariate calibration and classification. Volume 6. NIR Chichester, 2002.">NaesIFD02</a>]</span>.</p>
</section>
<section id="visualising-the-rules-of-thumb-on-our-first-attempted-parafac-model">
<h3>Visualising the rules-of-thumb on our first attempted PARAFAC model<a class="headerlink" href="#visualising-the-rules-of-thumb-on-our-first-attempted-parafac-model" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tlviz</span><span class="o">.</span><span class="n">visualisation</span><span class="o">.</span><span class="n">outlier_plot</span><span class="p">(</span>
    <span class="n">first_attempt</span><span class="p">,</span>
    <span class="n">X</span><span class="p">,</span>
    <span class="n">leverage_rules_of_thumb</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;p-value&quot;</span><span class="p">,</span> <span class="s2">&quot;hotelling&quot;</span><span class="p">,</span> <span class="s2">&quot;huber higher&quot;</span><span class="p">,</span> <span class="s2">&quot;huber lower&quot;</span><span class="p">,</span> <span class="s2">&quot;hw lower&quot;</span><span class="p">,</span> <span class="s2">&quot;hw higher&quot;</span><span class="p">],</span>
    <span class="n">residual_rules_of_thumb</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;p-value&quot;</span><span class="p">,</span> <span class="s2">&quot;two sigma&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_outlier_detection_009.png" srcset="../_images/sphx_glr_plot_outlier_detection_009.png" alt="Outlier plot for Mode 0" class = "sphx-glr-single-img"/><p>We see that in this case,
all thresholds except <code class="docutils literal notranslate"><span class="pre">&quot;huber</span> <span class="pre">lower&quot;</span></code> successfully detected the outliers.
However, with real data, it is usually not this clear.
Different cut-off values can give different outliers.
Therefore, it is crucial to look at the data and evaluate which data points
to remove and not on a case-by-case basis.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  5.182 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-plot-outlier-detection-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/8ef23ee1eaf9bbf29ebce5cb807c84f3/plot_outlier_detection.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_outlier_detection.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/114ec741bad9663cf99bd36ece9955e8/plot_outlier_detection.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_outlier_detection.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>
</section>


        </div>

		
        <nav class="pagination" role="navigation" aria-label="pagination">
    
    <a class="button is-medium pagination-previous" href="plot_selecting_aminoacids_components.html" title="previous page" accesskey="p">
        <span class="icon">
            <i class="fa fa-arrow-circle-left"></i>
        </span>
        <span>Selecting the number of components in PARAFAC models</span>
    </a>
    
    
    <a class="button is-medium pagination-next" href="../api.html" title="next page" accesskey="n">
        <span>API Reference </span>
        <span class="icon">
            <i class="fa fa-arrow-circle-right"></i>
        </span>
    </a>
    
</nav>

        

      </section>

        <footer class="footer">
    <div class="content has-text-centered">
        <div class="block">
          &copy; Copyright 2021, Marie Roald &amp; Yngve Mardal Moe.<br/>
        </div>
      <div class="block">
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> and the <a href="tensorly.org"><strong>TensorLy</strong></a> theme by <a href="jeankossaifi.com">Jean Kossaifi</a>.
      </div>
    </div>
  </footer>

    </div>

	
    
    <div class="column is-hidden-touch is-2-desktop is-one-fifth-widescreen" id="localtoc-column">

    <aside class="sticky-nav localtoc">  
        <div class="menu menu-list">
        <p class="menu-label">On this page</p>
        <ul>
<li><a class="reference internal" href="#">Outlier detection with PARAFAC</a><ul>
<li><a class="reference internal" href="#residuals">Residuals</a></li>
<li><a class="reference internal" href="#leverage">Leverage</a></li>
<li><a class="reference internal" href="#examples-with-code">Examples with code</a><ul>
<li><a class="reference internal" href="#utility-for-fitting-parafac-models-and-sampling-cp-tensors">Utility for fitting PARAFAC models and sampling CP tensors</a></li>
<li><a class="reference internal" href="#generate-simulated-dataset">Generate simulated dataset</a></li>
<li><a class="reference internal" href="#plotting-the-components">Plotting the components</a></li>
<li><a class="reference internal" href="#adding-artificial-noise">Adding artificial noise</a></li>
<li><a class="reference internal" href="#adding-artificial-outliers">Adding artificial outliers</a></li>
<li><a class="reference internal" href="#fitting-a-parafac-model-to-this-data-and-plotting-the-components">Fitting a PARAFAC model to this data and plotting the components</a></li>
<li><a class="reference internal" href="#rules-of-thumb-for-selecting-the-samples-that-may-be-outliers">Rules-of-thumb for selecting the samples that may be outliers</a></li>
<li><a class="reference internal" href="#visualising-the-rules-of-thumb-on-our-first-attempted-parafac-model">Visualising the rules-of-thumb on our first attempted PARAFAC model</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
    </aside>
    </div>

    

  </div>
  </div>

  <!-- Include here scripts that need to be added after the page is loaded -->
  <script>
    function toggle_sidebar() {
        var element = document.getElementById("sidebar");
        var container = document.getElementById("column-container");
        var localtoccolumn = document.getElementById("localtoc-column");
        element.classList.toggle("hide-tablet");
        element.classList.toggle("is-hidden-mobile");
        container.classList.toggle("sidemenu-hidden");
        localtoccolumn.classList.toggle("is-one-fifth-widescreen");
        localtoccolumn.classList.toggle("is-2-desktop");
        localtoccolumn.classList.toggle("is-3-desktop");
    }
  </script> 



  </body>
</html>