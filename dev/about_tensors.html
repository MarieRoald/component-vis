
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>What are tensors and tensor decompositions? &#8212; TLViz 0.0.9 documentation</title> 
<link rel="stylesheet" href="_static/tensorly_style.css">
<link rel="apple-touch-icon" sizes="180x180" href="_static/favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="_static/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="_static/favicon/favicon-16x16.png">
<link rel="manifest" href="_static/favicon/site.webmanifest">
<link rel="mask-icon" href="_static/favicon/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="_static/favicon/favicon.ico">
<meta name="theme-color" content="#ffffff">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/tensorly_style.css" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-rendered-html.css" />

  
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
 <script src="_static/navbar_burger.js"></script>
 <script defer src="https://use.fontawesome.com/releases/v5.14.0/js/all.js"></script>
 
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Installation" href="installation.html" />
    <link rel="prev" title="TLViz — Visualising and analysing component models" href="index.html" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

  </head>
<body  class="has-navbar-fixed-top">

  <header>
    <navbar>
      <nav class="navbar top-navbar is-fixed-top has-shadow is-flex-wrap-wrap" role="navigation" aria-label="main top navigation">
        <div class="navbar-brand">
        <!-- Always displayed, last item has to be navbar-burger -->

          <a class="navbar-item" href="index.html">
            <img src="_static/tlviz_logo.svg" height="28">
          </a>

          <!-- <a class="navbar-item is-hidden-desktop" href="index.html">
            <span class="icon"><i class="fa fa-home" aria-hidden="true"></i></span>
          </a> -->
          <a class="navbar-item is-hidden-desktop" href="https://github.com/tensorly/viz" target="_blank">
              <span class="icon"><i class="fab fa-github"></i></span>
          </a>

          <a role="button" class="navbar-burger" data-target="top-nav-menu" aria-label="menu" aria-expanded="false">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
          </a>

        </div>
        
        <div class="navbar-menu" id="top-nav-menu">
        <!-- only on larger displays (> 1024px) -->

          <div class="navbar-start">
          <!-- RIGHT -->
            <a class="navbar-item" href="#">
              Introduction
            </a>
            <a class="navbar-item" href="installation.html">
              Installation
            </a>
            <a class="navbar-item" href="auto_examples/index.html">
              Examples
            </a>
            <a class="navbar-item" href="api.html">
              API
            </a>
            <a class="navbar-item" href="https://tensorly.org" target="_blank">
              TensorLy
            </a>

          </div>
        
          <div class="navbar-end">
            <div class="navbar-item">
            <!-- LEFT -->

            <!-- <a class="navbar-item is-hidden-touch" href="index.html">
              <span class="icon-text">
                <span class="icon">
                  <i class="fa fa-home"></i>
                </span>
                <span>Home</span>
              </span>
              <span class="icon"><i class="fa fa-home" aria-hidden="true"></i></span>
            </a> -->
            <a class="button is-hidden-touch is-dark" href="https://github.com/tensorly/viz" target="_blank">
              <span class="icon-text">
                <span class="icon is-large">
                  <i class="fab fa-github"></i>
                </span>
                <span>Github</span>
              </span>
                <!-- <span class="icon"><i class="fab fa-github"></i></span> -->
            </a>

            </div> <!-- navbar item -->
          </div> <!-- navbar end -->
        </div> <!-- only large items -->

      </nav>
      
    </navbar>
  </header>

  <div id="column-container">
  <div class="columns is-mobile is-centered">
	
      <div class="column is-10-mobile is-one-third-tablet is-3-desktop is-hidden-mobile" id="sidebar">
    <!-- Side menu  -->
    <aside class="sticky-nav sidebar-menu">
<div class="sidebar-search">
  <form class="field" id="searchbox" role="search" action="search.html" method="get">
    <!-- <label class="label" id="searchlabel">Quick search</label> -->
    <div class="field has-addons">
      <div class="control is-expanded">
        <input class="input" type="text" placeholder="Search in TLViz" name="q" aria-labelledby="searchlabel">
      </div>
      <div class="control">
        <input class="button is-info" type="submit" value="Go" />
      </div>
    </div>
  </form>
  <script>$('#searchbox').show(0);</script>
  <script>
  $(document).ready(function() {
    Document.highlightSearchWords = function() {
      var params = $.getQueryParameters();
      var terms = (params.highlight) ? params.highlight[0].split(/\s+/) : [];
      if (terms.length) {
        var body = $('div.body');
        if (!body.length) {
          body = $('body');
        }
        window.setTimeout(function() {
          $.each(terms, function() {
            body.highlightText(this.toLowerCase(), 'highlighted');
          });
        }, 10);
        $('<p class="highlight-link"><a href="javascript:Documentation.' +
          'hideSearchWords()">' + _('Hide All')
          + '<span class="tag is-delete"></span>'
          + '</a></p>')
            .appendTo($('#searchbox'));
      }
    };
  });
  </script>
</div>
      
      <div class="sidebar-menu-toc">
      <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">What are tensors and tensor decompositions?</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#notation">Notation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#what-are-tensor-factorisations">What are tensor factorisations?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="auto_examples/index.html">Gallery of examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="tensorly_backends.html">Working with TensorLy</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contribution guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>
 
      </div>
    </aside>
  </div>
  

    <div class="column main-column">

      <!-- Main content  -->
      <section class="main-section">

        <!-- Toggle menu button -->
		
        <div class="side-menu-toggle">
          <button class="button" id="toggle-sidebar" onclick="toggle_sidebar()">
            <span class="icon"><i class="fa fa-bars" aria-hidden="true"></i></span>
            <span>menu</span> 
          </button>
        </div>
        

        <div class="content main-content">
          
  <section id="what-are-tensors-and-tensor-decompositions">
<span id="about-tensors"></span><h1>What are tensors and tensor decompositions?<a class="headerlink" href="#what-are-tensors-and-tensor-decompositions" title="Permalink to this headline">¶</a></h1>
<p>Tensors are higher-order generalisations of a matrix.
A matrix is a square of numbers and is, therefore, a second-order tensor.
However, we can also have a cube of numbers, which would be a third-order tensor.
So, a third-order tensor is a three-dimensional cube of numbers.
However, since <em>dimensions</em> often denote the number of entries in a vector, we do not use the word
dimension for tensors. Instead, we use the word <em>mode</em> <span id="id1">[<a class="reference internal" href="references.html#id22" title="Tamara G Kolda and Brett W Bader. Tensor decompositions and applications. SIAM review, 51(3):455–500, 2009.">KB09</a>]</span>.</p>
<p>Tensors in Python are often represented by NumPy arrays, and NumPy uses the word <em>axis</em> for the different modes.
Therefore, in TLViz, we alias <code class="docutils literal notranslate"><span class="pre">mode</span></code> and <code class="docutils literal notranslate"><span class="pre">axis</span></code> in all the function calls.
However, the word <code class="docutils literal notranslate"><span class="pre">mode</span></code> is generally used in the documentation.</p>
<section id="notation">
<h2>Notation<a class="headerlink" href="#notation" title="Permalink to this headline">¶</a></h2>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/cp_tensor.svg"><img alt="Illustration of a CP tensor" src="_images/cp_tensor.svg" width="90%" /></a>
</figure>
<p>Above, we see an illustration of the notation used in TLViz.
We represent dense tensors either as NumPy arrays,
Pandas DataFrames or xarray DataArrays with the name <code class="docutils literal notranslate"><span class="pre">dataset</span></code>.
PARAFAC (or CP or CPD) models are represented by a tuple, where the first element is a vector of weights,
one for each component, and the second element is a list of factor matrices, one for each mode.
This form is compatible with TensorLy, and we have also taken care to give variables
on this form the name <code class="docutils literal notranslate"><span class="pre">cp_tensor</span></code> to match TensorLy.</p>
<p>In TLViz, we also use the terms <em>labelled</em> and <em>unlabelled</em> dataset and decompositions.
A labelled dataset is either a Pandas DataFrame or an xarray DataArray.
By using Pandas and xarray objects, we keep the metadata together with the dataset,
making it easier to produce rich visualisations later.
Similarly, a labelled decomposition is a decomposition where the factor matrices are stored as Pandas DataFrames
with an index equal to the coordinates along the corresponding mode of the xarray DataArray.
TLViz can seamlessly work with both labelled and unlabelled data and decompositions,
but we recommend using the labelled variant whenever possible.</p>
</section>
<section id="what-are-tensor-factorisations">
<h2>What are tensor factorisations?<a class="headerlink" href="#what-are-tensor-factorisations" title="Permalink to this headline">¶</a></h2>
<p>Similarly to matrix factorisation methods, tensor factorisation methods decompose a tensor into low-rank components.
These components can be very informative and give insight into the patterns in the data.
One of the most commonly used tensor factorisation methods is PARAFAC (also known as CP and CPD).
PARAFAC can be considered a generalisation of two-way methods such as principal component analysis (PCA) and nonnegative matrix factorisation (NMF) to higher-order data.
Let us here see how PARAFAC decomposition relates to matrix decomposition.
With matrix factorisation, we describe a matrix, <span class="math notranslate nohighlight">\(\mathbf{X}\)</span>, as the outer product of two-factor matrices:</p>
<div class="math notranslate nohighlight">
\[\mathbf{X} \approx \mathbf{A} \mathbf{B}^\mathsf{T},\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{B}\)</span> are <em>factor matrices</em> that contain the patterns along the rows and
columns of <span class="math notranslate nohighlight">\(\mathbf{X}\)</span>. The first component is represented by the first columns of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{B}\)</span>,
the second component is represented by the second columns and so forth.</p>
<p>We can look at an example to better understand these factor matrices. If <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> is a matrix
of movie scores given by various users, then each component could represent a genre and the <span class="math notranslate nohighlight">\(i\)</span>-th row of
<span class="math notranslate nohighlight">\(\mathbf{A}\)</span> could contain information about which movie genres the <span class="math notranslate nohighlight">\(i\)</span>-th user likes. Likewise, the
<span class="math notranslate nohighlight">\(j\)</span>-th row of <span class="math notranslate nohighlight">\(\mathbf{B}\)</span> could contain information about how “strongly” each movie belonged to each
genre.</p>
<p>The next step is to generalise this for more dimensions. We may for example have time. In that case, we have a
tensor, <span class="math notranslate nohighlight">\(\mathcal{X}\)</span>, which represents how much different people like different movies at different time
points. To see how we can matrix factorisation for such a case, we first rewrite the equation above so we consider
each entry, <span class="math notranslate nohighlight">\(x_{ij}\)</span>, of <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> instead:</p>
<div class="math notranslate nohighlight">
\[x_{ij} \approx \sum_{r=1}^R a_{ir} b_{jr}.\]</div>
<p>If we now introduce a third mode (represented by a new index, <span class="math notranslate nohighlight">\(k\)</span>), we see an obvious way to extend this</p>
<div class="math notranslate nohighlight">
\[x_{ijk} \approx \sum_{r=1}^R a_{ir} b_{jr} c_{kr}.\]</div>
<p>Here, we have three sets of factor matrices, <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>, <span class="math notranslate nohighlight">\(\mathbf{B}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{C}\)</span>.
In the movie example, the first two factor matrices still represent the same. The third-factor matrix,
<span class="math notranslate nohighlight">\(\mathbf{C}\)</span> represents how popular the different genres are at different time points.</p>
<p>The model we just described is called the PARAFAC, CP or CPD model.
However, it is also common to introduce <em>weights</em> to the components.
These weights represent each component’s “signal strength” (similar to a singular value if you are familiar with the SVD).
If we include the weights in the equation
above, we get</p>
<div class="math notranslate nohighlight">
\[x_{ijk} \approx \sum_{r=1}^R w_r a_{ir} b_{jr} c_{kr}.\]</div>
<p>This overview was only a very brief introduction to tensor factorisations.
For a more thorough introduction, we recommend <span id="id2">[<a class="reference internal" href="references.html#id22" title="Tamara G Kolda and Brett W Bader. Tensor decompositions and applications. SIAM review, 51(3):455–500, 2009.">KB09</a>]</span> (a thorough introduction to tensors)
and <span id="id3">[<a class="reference internal" href="references.html#id10" title="Rasmus Bro. Parafac. tutorial and applications. Chemometrics and intelligent laboratory systems, 38(2):149–171, 1997.">Bro97</a>]</span> (a thorough introduction to PARAFAC).</p>
</section>
</section>


        </div>

		
        <nav class="pagination" role="navigation" aria-label="pagination">
    
    <a class="button is-medium pagination-previous" href="index.html" title="previous page" accesskey="p">
        <span class="icon">
            <i class="fa fa-arrow-circle-left"></i>
        </span>
        <span>TLViz — Visualising and analysing component models</span>
    </a>
    
    
    <a class="button is-medium pagination-next" href="installation.html" title="next page" accesskey="n">
        <span>Installation </span>
        <span class="icon">
            <i class="fa fa-arrow-circle-right"></i>
        </span>
    </a>
    
</nav>

        

      </section>

        <footer class="footer">
    <div class="content has-text-centered">
        <div class="block">
          &copy; Copyright 2021, Marie Roald &amp; Yngve Mardal Moe.<br/>
        </div>
      <div class="block">
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> and the <a href="tensorly.org"><strong>TensorLy</strong></a> theme by <a href="jeankossaifi.com">Jean Kossaifi</a>.
      </div>
    </div>
  </footer>

    </div>

	
    
    <div class="column is-hidden-touch is-2-desktop is-one-fifth-widescreen" id="localtoc-column">

    <aside class="sticky-nav localtoc">  
        <div class="menu menu-list">
        <p class="menu-label">On this page</p>
        <ul>
<li><a class="reference internal" href="#">What are tensors and tensor decompositions?</a><ul>
<li><a class="reference internal" href="#notation">Notation</a></li>
<li><a class="reference internal" href="#what-are-tensor-factorisations">What are tensor factorisations?</a></li>
</ul>
</li>
</ul>

        </div>
    </aside>
    </div>

    

  </div>
  </div>

  <!-- Include here scripts that need to be added after the page is loaded -->
  <script>
    function toggle_sidebar() {
        var element = document.getElementById("sidebar");
        var container = document.getElementById("column-container");
        var localtoccolumn = document.getElementById("localtoc-column");
        element.classList.toggle("hide-tablet");
        element.classList.toggle("is-hidden-mobile");
        container.classList.toggle("sidemenu-hidden");
        localtoccolumn.classList.toggle("is-one-fifth-widescreen");
        localtoccolumn.classList.toggle("is-2-desktop");
        localtoccolumn.classList.toggle("is-3-desktop");
    }
  </script> 



  </body>
</html>